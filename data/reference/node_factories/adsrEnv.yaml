nodeFactory:
  name: adsrEnv
  desc: |
    これは**一般的な**
    ADSR エンベロープ
    です。

  # 入力がないことを表す記法。入力がある場合はテキストで記述する
  input: |
    %noInput

  params:
    -
      name: attack
      required: false
      default:
        value: 0
        # behavior: すごいことになる
      desc: |
        アタックタイムです。
        値が 1 になるまでの時間を秒で指定します。
    -
      name: decay
      required: true # 仮

  events:
    -
      type: Note

  output:
    range: [0, 1]
    desc: |
      ノートオンの瞬間 initial を出力します。
      そこから出力は線形に増加し、attack 秒後に最大値 1 を出力します。
      その後 decay 秒をかけて、出力は線形に sustain まで減少します。
      ノートオフを受け取ると、その瞬間から

  # sample とか caution のようなブロック記述か、文字列（普通のテキスト）を好きな順に並べる
  details:
    -
      出力値の範囲は [0, 1] です。ってこれも構造化した方がいい気がする
    -
      sample:
        code: |
          pulseOsc * adsrEnv { attack: 0.5, release: 0.25 }
        desc: |
          オシレータに対してエンベロープを適用します。
    -
      # この注意は全てのエンベロープに共通なので部品化したいが
      caution:
        -
          次のように、エンベロープをパイプで接続しないでください：
        -
          sample:
            code: |
              pulseOsc | adsrEnv { attack: 0.5, release: 0.25 }
            desc: |
              オシレータの出力にエンベロープを適用することを意図していますが、そうはなりません。
        - |
          エンベロープは「入力にエンベロープを適用するエフェクト」ではなく、「エンベロープを出力するジェネレータ」であり、入力を取りません。
          エンベロープをエフェクトとして接続すると、オシレータの出力は無視され、最終的な出力はエンベロープの値だけになってしまいます（音としては聞こえません）。
          エンベロープを適用するには `*` を使ってください。




