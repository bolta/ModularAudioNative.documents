construction:
  name: waveform
  desc: |
    波形を定義します。

    波形データは音声ファイルから読み込むほか、直接記述することもできます。

  params:
    -
      name: |
        `name`
      type: QuotedIdentifier
      required: true
      desc: |
        波形を割り当てる変数の名前を指定します。

    -
      name: |
        `spec`
      type: Assoc | String
      required: true
      desc:
        - |
          連想で波形の情報を記述します。

          読み込む音声ファイルのパスだけを文字列で指定することもできます。その場合、連想配列で `path` だけを指定したのと同じ結果になります。

        -
          table:
            head:
              - キー
              - 値の型
              - 値
            body:
              -
                - "`data`"
                - Array
                - |
                  波形データを配列で記述します。

                  `data` と `path` のどちらか一方だけを必ず記述しなければなりません。
              -
                - "`path`"
                - String
                - |
                  読み込む音声ファイルのパスを指定します。

                  `data` と `path` のどちらか一方だけを必ず記述しなければなりません。
              -
                - "`sampleRate`"
                - Number
                - |
                  サンプルレート [Hz] を指定します。

                  `data` を記述する場合は必須です。

                  `path` を記述する場合は省略でき、省略した場合は音声ファイルのサンプルレートが使われます。
              -
                - "`originalFreq`"
                - Number
                - |
                  波形を本来の速度で再生した場合に発生する音の周波数 [Hz] を指定します。

                  省略した場合、`o4c` の周波数と見なされます。
              -
                - "`startOffset`"
                - Number
                - |
                  波形の再生を開始する位置 [サンプル] を指定します。

                  省略した場合、`0` と見なされます。
              -
                - "`endOffset`"
                - Number
                - |
                  波形の再生を終了する位置 [サンプル] を指定します。

                  省略した場合、波形の終点と見なされます。
              -
                - "`loopOffset`"
                - Number
                - |
                  波形をループ再生する場合、再生位置が `endOffset` に達した後に戻る位置 [サンプル] を指定します。

                  省略した場合、ループ再生しません。

  details:
    - |
      %constr(waveform) 文は次の 2 つを連続して行います：

      * `spec` の記述を元に、ModDL 処理系内部の領域に波形を構築します。
      * `name` で指定された名前の変数を定義し、先ほど構築した波形を参照する %type(Waveform) 型の値を割り当てます。

      %constr(waveform) 文の使い方の詳細は、「%link(/reference/moddl/features/waveforms)」を参照してください。

